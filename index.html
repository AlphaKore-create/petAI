<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PetPsych AI - Understanding Your Pet's Mind</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
</head>
<body>
    <!-- Demo Notification -->
    <div class="demo-notification">
        <div class="alert alert-info alert-dismissible fade show">
            <i class="fas fa-brain me-2"></i>
            <strong>AI Ready:</strong> Advanced pet psychology analysis powered by Gemini AI
            <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
        </div>
    </div>

    <!-- Navigation -->
    <nav class="navbar navbar-expand-lg">
        <div class="container">
            <a class="navbar-brand" href="#">
                <div class="brand-logo">
                    <svg width="40" height="40" viewBox="0 0 100 100" class="logo-svg">
                        <defs>
                            <linearGradient id="logoGradient" x1="0%" y1="0%" x2="100%" y2="100%">
                                <stop offset="0%" style="stop-color:#00D4AA;stop-opacity:1" />
                                <stop offset="100%" style="stop-color:#0FA3D4;stop-opacity:1" />
                            </linearGradient>
                        </defs>
                        <!-- Dog silhouette -->
                        <path d="M35 25 C40 15, 55 15, 65 25 C70 30, 70 35, 65 40 C60 45, 55 50, 50 55 C45 50, 40 45, 35 40 C30 35, 30 30, 35 25 Z" fill="url(#logoGradient)"/>
                        <!-- Cat silhouette -->
                        <path d="M25 45 C30 35, 45 35, 55 45 C60 50, 60 55, 55 60 C50 65, 45 70, 40 75 C35 70, 30 65, 25 60 C20 55, 20 50, 25 45 Z" fill="url(#logoGradient)" opacity="0.8"/>
                        <!-- Eyes -->
                        <circle cx="42" cy="32" r="2" fill="#1e3a5f"/>
                        <circle cx="58" cy="32" r="2" fill="#1e3a5f"/>
                        <circle cx="32" cy="52" r="1.5" fill="#1e3a5f"/>
                        <circle cx="48" cy="52" r="1.5" fill="#1e3a5f"/>
                    </svg>
                </div>
                <span class="brand-text">PetPsych AI</span>
            </a>
            <div class="navbar-nav ms-auto">
                <div class="nav-status">
                    <span class="status-dot"></span>
                    <span class="status-text">AI Online</span>
                </div>
            </div>
        </div>
    </nav>

    <!-- Hero Section -->
    <section class="hero-section">
        <div class="container">
            <div class="row justify-content-center text-center">
                <div class="col-lg-8">
                    <div class="hero-content">
                        <div class="hero-logo-large mb-4">
                            <svg width="120" height="120" viewBox="0 0 100 100" class="hero-logo-svg">
                                <defs>
                                    <linearGradient id="heroLogoGradient" x1="0%" y1="0%" x2="100%" y2="100%">
                                        <stop offset="0%" style="stop-color:#00D4AA;stop-opacity:1" />
                                        <stop offset="100%" style="stop-color:#0FA3D4;stop-opacity:1" />
                                    </linearGradient>
                                </defs>
                                <!-- Dog silhouette -->
                                <path d="M35 25 C40 15, 55 15, 65 25 C70 30, 70 35, 65 40 C60 45, 55 50, 50 55 C45 50, 40 45, 35 40 C30 35, 30 30, 35 25 Z" fill="url(#heroLogoGradient)"/>
                                <!-- Cat silhouette -->
                                <path d="M25 45 C30 35, 45 35, 55 45 C60 50, 60 55, 55 60 C50 65, 45 70, 40 75 C35 70, 30 65, 25 60 C20 55, 20 50, 25 45 Z" fill="url(#heroLogoGradient)" opacity="0.8"/>
                                <!-- Brain pattern overlay -->
                                <path d="M42 28 C45 25, 50 25, 53 28 C55 30, 55 32, 53 34 M38 48 C41 45, 46 45, 49 48 C51 50, 51 52, 49 54" stroke="#ffffff" stroke-width="1" fill="none" opacity="0.6"/>
                            </svg>
                        </div>
                        <h1 class="hero-title">Understanding Your Pet's Mind</h1>
                        <p class="hero-subtitle">Advanced AI psychology that decodes your pet's behaviors, emotions, and thoughts into meaningful insights for deeper bonding.</p>
                        <div class="hero-features">
                            <div class="feature-pill">
                                <i class="fas fa-brain"></i>
                                <span>AI Psychology</span>
                            </div>
                            <div class="feature-pill">
                                <i class="fas fa-video"></i>
                                <span>Live Analysis</span>
                            </div>
                            <div class="feature-pill">
                                <i class="fas fa-heart"></i>
                                <span>Emotional Intelligence</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Main Content -->
    <div class="container my-5">
        <div class="row justify-content-center">
            <div class="col-lg-10">
                <div class="main-card fade-in">
                    <div class="card-body">
                        <!-- Tabs -->
                        <ul class="nav nav-tabs" id="mainTab" role="tablist">
                            <li class="nav-item" role="presentation">
                                <button class="nav-link active" id="form-tab" data-bs-toggle="tab" data-bs-target="#form"
                                        type="button" role="tab" aria-selected="true">
                                    <i class="fas fa-edit me-2"></i>
                                    <span>Behavioral Input</span>
                                </button>
                            </li>
                            <li class="nav-item" role="presentation">
                                <button class="nav-link" id="camera-tab" data-bs-toggle="tab" data-bs-target="#camera"
                                        type="button" role="tab" aria-selected="false">
                                    <i class="fas fa-video me-2"></i>
                                    <span>Live Capture</span>
                                </button>
                            </li>
                        </ul>

                        <div class="tab-content" id="tabContent">
                            <!-- Form Tab -->
                            <div class="tab-pane fade show active" id="form" role="tabpanel">
                                <div class="form-container">
                                    <div class="form-header">
                                        <h4><i class="fas fa-clipboard-list me-2"></i>Pet Behavioral Analysis</h4>
                                        <p class="text-muted">Provide detailed information about your pet's behavior for comprehensive AI analysis</p>
                                    </div>

                                    <form id="petForm">
                                        <div class="row">
                                            <div class="col-md-6 mb-4">
                                                <label for="pet_name" class="form-label">
                                                    <i class="fas fa-heart text-danger me-2"></i>Pet's Name
                                                </label>
                                                <input type="text" class="form-control" id="pet_name" name="pet_name"
                                                       placeholder="Enter your pet's name" required>
                                            </div>
                                            <div class="col-md-6 mb-4">
                                                <label for="pet_breed" class="form-label">
                                                    <i class="fas fa-dna me-2"></i>Pet's Breed
                                                </label>
                                                <input type="text" class="form-control" id="pet_breed" name="pet_breed"
                                                       placeholder="e.g., Golden Retriever, Persian Cat" required>
                                            </div>
                                        </div>

                                        <div class="row">
                                            <div class="col-md-6 mb-4">
                                                <label for="pet_type" class="form-label">
                                                    <i class="fas fa-paw me-2"></i>Pet Type
                                                </label>
                                                <select class="form-select" id="pet_type" name="pet_type" required>
                                                    <option value="">Select pet type</option>
                                                    <option value="dog">üêï Dog</option>
                                                    <option value="cat">üê± Cat</option>
                                                    <option value="bird">üê¶ Bird</option>
                                                    <option value="rabbit">üê∞ Rabbit</option>
                                                    <option value="hamster">üêπ Hamster</option>
                                                    <option value="guinea pig">üêπ Guinea Pig</option>
                                                    <option value="ferret">ü¶´ Ferret</option>
                                                    <option value="other">üêæ Other</option>
                                                </select>
                                            </div>
                                        </div>

                                        <div class="mb-4">
                                            <label for="behavior_desc" class="form-label">
                                                <i class="fas fa-eye me-2"></i>Behavior Description
                                                <span class="badge bg-primary ms-2">Required</span>
                                            </label>
                                            <textarea class="form-control" id="behavior_desc" name="behavior_desc" rows="4"
                                                    placeholder="Describe your pet's behavior in detail (e.g., pacing back and forth, tail wagging rapidly, unusual vocalizations, body posture changes)" required></textarea>
                                        </div>

                                        <div class="mb-4">
                                            <label for="vocal_cues" class="form-label">
                                                <i class="fas fa-volume-up me-2"></i>Vocal Cues & Sounds
                                            </label>
                                            <textarea class="form-control" id="vocal_cues" name="vocal_cues" rows="3"
                                                    placeholder="Describe any sounds: barking patterns, meowing types, chirping, whimpering, purring intensity, etc."></textarea>
                                        </div>

                                        <div class="mb-4">
                                            <label for="context" class="form-label">
                                                <i class="fas fa-map-marker-alt me-2"></i>Environmental Context
                                                <i class="fas fa-question-circle tooltip-icon ms-2"
                                                   data-bs-toggle="tooltip"
                                                   title="Include environmental factors, recent changes, or events that might influence your pet's behavior"></i>
                                            </label>
                                            <textarea class="form-control" id="context" name="context" rows="3"
                                                    placeholder="Environment details: new home, visitors, weather changes, schedule disruptions, other pets, recent vet visits, etc."></textarea>
                                        </div>

                                        <div class="mb-4">
                                            <label for="video_file" class="form-label">
                                                <i class="fas fa-file-video me-2"></i>Upload Video (Optional)
                                            </label>
                                            <input class="form-control" type="file" id="video_file" name="video_file"
                                                   accept="video/*">
                                            <div class="form-text mt-2">
                                                <i class="fas fa-info-circle me-1"></i>
                                                Video uploads provide more accurate behavioral analysis
                                            </div>
                                        </div>

                                        <div class="text-center">
                                            <button type="submit" class="btn btn-primary btn-lg submit-btn">
                                                <i class="fas fa-brain me-2"></i>
                                                <span>Analyze Pet Psychology</span>
                                                <div class="btn-glow"></div>
                                            </button>
                                        </div>
                                    </form>
                                </div>
                            </div>

                            <!-- Camera Tab -->
                            <div class="tab-pane fade" id="camera" role="tabpanel">
                                <div class="text-center mb-4">
                                    <div class="feature-icon mx-auto">
                                        <i class="fas fa-video"></i>
                                    </div>
                                    <h4>Real-time Behavioral Capture</h4>
                                    <p class="text-muted">Use your camera to record live pet behavior for immediate AI analysis</p>
                                </div>

                                <div class="video-container">
                                    <div id="cameraPlaceholder">
                                        <div class="camera-icon">
                                            <i class="fas fa-camera"></i>
                                        </div>
                                        <h5>Camera Ready</h5>
                                        <p class="mb-0">Click "Start Camera" to begin recording your pet's behavior</p>
                                    </div>
                                    <video id="videoElement" style="display: none;" autoplay="true"></video>
                                </div>

                                <div class="text-center mb-4">
                                    <div class="action-buttons justify-content-center">
                                        <button id="startCameraBtn" class="btn btn-primary camera-btn">
                                            <i class="fas fa-play me-2"></i>Start Camera
                                        </button>
                                        <button id="captureBtn" class="btn btn-success camera-btn" style="display:none;">
                                            <i class="fas fa-record-vinyl me-2"></i>Start Recording
                                        </button>
                                        <button id="stopBtn" class="btn btn-danger camera-btn" style="display:none;">
                                            <i class="fas fa-stop me-2"></i>Stop Recording
                                        </button>
                                        <button id="stopCameraBtn" class="btn btn-secondary camera-btn" style="display:none;">
                                            <i class="fas fa-camera-slash me-2"></i>Turn Off Camera
                                        </button>
                                    </div>
                                </div>

                                <div id="cameraFormContainer" style="display:none;">
                                    <div class="form-container">
                                        <div class="form-header">
                                            <h5><i class="fas fa-plus-circle me-2"></i>Complete Your Analysis</h5>
                                            <p class="text-muted">Add contextual details to enhance AI analysis accuracy</p>
                                        </div>

                                        <form id="cameraForm">
                                            <div class="row">
                                                <div class="col-md-6 mb-4">
                                                    <label for="cam_pet_name" class="form-label">
                                                        <i class="fas fa-heart text-danger me-2"></i>Pet's Name
                                                    </label>
                                                    <input type="text" class="form-control" id="cam_pet_name" name="pet_name" required>
                                                </div>
                                                <div class="col-md-6 mb-4">
                                                    <label for="cam_pet_breed" class="form-label">
                                                        <i class="fas fa-dna me-2"></i>Pet's Breed
                                                    </label>
                                                    <input type="text" class="form-control" id="cam_pet_breed" name="pet_breed" required>
                                                </div>
                                            </div>

                                            <div class="row">
                                                <div class="col-md-6 mb-4">
                                                    <label for="cam_pet_type" class="form-label">
                                                        <i class="fas fa-paw me-2"></i>Pet Type
                                                    </label>
                                                    <select class="form-select" id="cam_pet_type" name="pet_type" required>
                                                        <option value="">Select pet type</option>
                                                        <option value="dog">üêï Dog</option>
                                                        <option value="cat">üê± Cat</option>
                                                        <option value="bird">üê¶ Bird</option>
                                                        <option value="rabbit">üê∞ Rabbit</option>
                                                        <option value="hamster">üêπ Hamster</option>
                                                        <option value="guinea pig">üêπ Guinea Pig</option>
                                                        <option value="ferret">ü¶´ Ferret</option>
                                                        <option value="other">üêæ Other</option>
                                                    </select>
                                                </div>
                                            </div>

                                            <div class="mb-4">
                                                <label for="cam_behavior_desc" class="form-label">
                                                    <i class="fas fa-eye me-2"></i>Observed Behavior
                                                </label>
                                                <textarea class="form-control" id="cam_behavior_desc" name="behavior_desc" rows="3"
                                                        placeholder="Describe what your pet was doing during the recording"></textarea>
                                            </div>

                                            <div class="mb-4">
                                                <label for="cam_vocal_cues" class="form-label">
                                                    <i class="fas fa-volume-up me-2"></i>Audio Cues
                                                </label>
                                                <textarea class="form-control" id="cam_vocal_cues" name="vocal_cues" rows="2"
                                                        placeholder="Sounds captured during recording"></textarea>
                                            </div>

                                            <div class="mb-4">
                                                <label for="cam_context" class="form-label">
                                                    <i class="fas fa-map-marker-alt me-2"></i>Recording Context
                                                </label>
                                                <textarea class="form-control" id="cam_context" name="context" rows="2"
                                                        placeholder="Environmental factors during recording"></textarea>
                                            </div>

                                            <input type="hidden" id="captured_video" name="captured_video">

                                            <div class="text-center">
                                                <button type="submit" class="btn btn-primary btn-lg submit-btn">
                                                    <i class="fas fa-brain me-2"></i>
                                                    <span>Analyze Captured Behavior</span>
                                                    <div class="btn-glow"></div>
                                                </button>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Loading Indicator -->
                <div class="loader" id="loader">
                    <div class="loader-content">
                        <div class="spinner"></div>
                        <div class="loader-logo">
                            <svg width="60" height="60" viewBox="0 0 100 100">
                                <defs>
                                    <linearGradient id="loaderGradient" x1="0%" y1="0%" x2="100%" y2="100%">
                                        <stop offset="0%" style="stop-color:#00D4AA;stop-opacity:1" />
                                        <stop offset="100%" style="stop-color:#0FA3D4;stop-opacity:1" />
                                    </linearGradient>
                                </defs>
                                <path d="M35 25 C40 15, 55 15, 65 25 C70 30, 70 35, 65 40 C60 45, 55 50, 50 55 C45 50, 40 45, 35 40 C30 35, 30 30, 35 25 Z" fill="url(#loaderGradient)"/>
                                <path d="M25 45 C30 35, 45 35, 55 45 C60 50, 60 55, 55 60 C50 65, 45 70, 40 75 C35 70, 30 65, 25 60 C20 55, 20 50, 25 45 Z" fill="url(#loaderGradient)" opacity="0.8"/>
                            </svg>
                        </div>
                        <h5>AI Analysis in Progress</h5>
                        <p class="text-muted mb-0">Decoding your pet's psychological patterns...</p>
                        <div class="progress-bar">
                            <div class="progress-fill"></div>
                        </div>
                    </div>
                </div>

                <!-- Analysis Results -->
                <div class="analysis-result slide-up" id="analysisResult" style="display: none;">
                    <div class="analysis-header">
                        <div class="analysis-icon">
                            <i class="fas fa-brain"></i>
                        </div>
                        <h3>Pet Psychology Analysis Report</h3>
                        <p class="analysis-subtitle">AI-powered behavioral insights and recommendations</p>
                    </div>
                    <div class="analysis-content">
                        <div id="analysisContent"></div>
                        <div class="action-buttons">
                            <button id="newAnalysisBtn" class="btn btn-primary">
                                <i class="fas fa-plus me-2"></i>New Analysis
                            </button>
                            <button id="downloadBtn" class="btn btn-secondary">
                                <i class="fas fa-download me-2"></i>Download Report
                            </button>
                            <button class="btn btn-outline-primary">
                                <i class="fas fa-share me-2"></i>Share Results
                            </button>
                        </div>
                    </div>
                    <div class="timestamp" id="timestamp"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer>
        <div class="container">
            <div class="footer-content">
                <div class="footer-logo">
                    <svg width="40" height="40" viewBox="0 0 100 100" class="footer-logo-svg">
                        <defs>
                            <linearGradient id="footerLogoGradient" x1="0%" y1="0%" x2="100%" y2="100%">
                                <stop offset="0%" style="stop-color:#00D4AA;stop-opacity:1" />
                                <stop offset="100%" style="stop-color:#0FA3D4;stop-opacity:1" />
                            </linearGradient>
                        </defs>
                        <path d="M35 25 C40 15, 55 15, 65 25 C70 30, 70 35, 65 40 C60 45, 55 50, 50 55 C45 50, 40 45, 35 40 C30 35, 30 30, 35 25 Z" fill="url(#footerLogoGradient)"/>
                        <path d="M25 45 C30 35, 45 35, 55 45 C60 50, 60 55, 55 60 C50 65, 45 70, 40 75 C35 70, 30 65, 25 60 C20 55, 20 50, 25 45 Z" fill="url(#footerLogoGradient)" opacity="0.8"/>
                    </svg>
                    <span>PetPsych AI</span>
                </div>
                <p class="mb-2">Understanding your pet's mind through advanced AI psychology</p>
                <small class="text-muted">Powered by Gemini 1.5 Pro ‚Ä¢ ¬© 2025 PetPsych AI</small>
                <div class="footer-links mt-3">
                    <a href="#" class="footer-link">Privacy Policy</a>
                    <a href="#" class="footer-link">Terms of Service</a>
                    <a href="#" class="footer-link">Support</a>
                </div>
            </div>
        </div>
    </footer>

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // Working JavaScript for Beautiful PetPsych AI
        console.log('üß† PetPsych AI Loading...');

        let analysisInProgress = false;
        let currentAnalysis = '';

        // Initialize when DOM loads
        document.addEventListener('DOMContentLoaded', function() {
            console.log('üìÑ Beautiful version loading...');
            initializeApp();
        });

        function initializeApp() {
            // Initialize tooltips
            const tooltipTriggerList = [].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]'));
            tooltipTriggerList.map(function (tooltipTriggerEl) {
                return new bootstrap.Tooltip(tooltipTriggerEl);
            });

            // Setup form handlers
            setupFormHandlers();

            // Setup animations
            setupAnimations();

            console.log('‚úÖ Beautiful PetPsych AI initialized');
        }

        function setupFormHandlers() {
            const petForm = document.getElementById('petForm');
            const cameraForm = document.getElementById('cameraForm');

            if (petForm) {
                petForm.addEventListener('submit', function(e) {
                    e.preventDefault();
                    console.log('üìù Pet form submitted');
                    submitForm(this);
                });
            }

            if (cameraForm) {
                cameraForm.addEventListener('submit', function(e) {
                    e.preventDefault();
                    console.log('üìπ Camera form submitted');
                    submitForm(this);
                });
            }

            // Button handlers
            const newAnalysisBtn = document.getElementById('newAnalysisBtn');
            if (newAnalysisBtn) {
                newAnalysisBtn.addEventListener('click', resetForNewAnalysis);
            }

            const downloadBtn = document.getElementById('downloadBtn');
            if (downloadBtn) {
                downloadBtn.addEventListener('click', downloadReport);
            }
        }

        function setupAnimations() {
            // Add hover effects to cards
            const cards = document.querySelectorAll('.main-card, .form-container');
            cards.forEach(card => {
                card.addEventListener('mouseenter', function() {
                    this.style.transform = 'translateY(-5px)';
                });

                card.addEventListener('mouseleave', function() {
                    this.style.transform = 'translateY(0)';
                });
            });

            // Logo animations
            const logos = document.querySelectorAll('.logo-svg, .hero-logo-svg');
            logos.forEach(logo => {
                logo.addEventListener('mouseenter', function() {
                    this.style.transform = 'scale(1.1) rotate(5deg)';
                });

                logo.addEventListener('mouseleave', function() {
                    this.style.transform = 'scale(1) rotate(0deg)';
                });
            });
        }

        async function submitForm(form) {
            if (analysisInProgress) {
                showNotification('Analysis already in progress...', 'warning');
                return;
            }

            // Validate form
            if (!validateForm(form)) {
                return;
            }

            analysisInProgress = true;

            try {
                // Show loading with beautiful animation
                showLoader();
                hideTabContent();

                // Prepare and send request
                const formData = new FormData(form);
                console.log('üì§ Sending beautiful analysis request...');

                const response = await fetch('/analyze_behavior', {
                    method: 'POST',
                    body: formData
                });

                console.log('üì• Response received:', response.status);

                if (!response.ok) {
                    throw new Error(`Server error: ${response.status}`);
                }

                const result = await response.json();
                console.log('üìä Beautiful result received:', result.success);

                // Display results with beautiful styling
                displayBeautifulResults(result);

            } catch (error) {
                console.error('üí• Beautiful analysis failed:', error);
                showNotification('Analysis failed: ' + error.message, 'error');
                showTabContent();
            } finally {
                hideLoader();
                analysisInProgress = false;
            }
        }

        function validateForm(form) {
            const requiredFields = form.querySelectorAll('[required]');
            let isValid = true;

            requiredFields.forEach(field => {
                if (!field.value.trim()) {
                    field.classList.add('is-invalid');
                    isValid = false;
                } else {
                    field.classList.remove('is-invalid');
                    field.classList.add('is-valid');
                }
            });

            if (!isValid) {
                showNotification('Please fill in all required fields', 'error');
            }

            return isValid;
        }

        function showLoader() {
            const loader = document.getElementById('loader');
            if (loader) {
                loader.style.display = 'block';
                loader.style.opacity = '0';
                setTimeout(() => {
                    loader.style.transition = 'opacity 0.5s ease';
                    loader.style.opacity = '1';
                }, 100);
                console.log('‚è≥ Beautiful loader shown');
            }
        }

        function hideLoader() {
            const loader = document.getElementById('loader');
            if (loader) {
                loader.style.opacity = '0';
                setTimeout(() => {
                    loader.style.display = 'none';
                }, 300);
                console.log('‚úÖ Beautiful loader hidden');
            }
        }

        function hideTabContent() {
            const tabContent = document.getElementById('tabContent');
            if (tabContent) {
                tabContent.style.transition = 'opacity 0.3s ease, transform 0.3s ease';
                tabContent.style.opacity = '0.3';
                tabContent.style.transform = 'scale(0.98)';
                tabContent.style.pointerEvents = 'none';
                console.log('üìù Beautiful form hidden');
            }
        }

        function showTabContent() {
            const tabContent = document.getElementById('tabContent');
            if (tabContent) {
                tabContent.style.opacity = '1';
                tabContent.style.transform = 'scale(1)';
                tabContent.style.pointerEvents = 'auto';
                console.log('üìù Beautiful form shown');
            }
        }

        function displayBeautifulResults(result) {
            console.log('üé® Displaying beautiful results...');

            if (result.success) {
                currentAnalysis = result.analysis;

                // Format analysis with beautiful styling
                const formattedAnalysis = formatBeautifulAnalysis(result.analysis);

                // Update analysis content
                const analysisContent = document.getElementById('analysisContent');
                const timestamp = document.getElementById('timestamp');
                const analysisResult = document.getElementById('analysisResult');

                if (analysisContent) {
                    analysisContent.innerHTML = formattedAnalysis;
                }

                if (timestamp) {
                    timestamp.textContent = `Analysis completed: ${result.timestamp}`;
                }

                // Show results with beautiful animation
                if (analysisResult) {
                    analysisResult.style.display = 'block';
                    analysisResult.style.opacity = '0';
                    analysisResult.style.transform = 'translateY(30px)';

                    setTimeout(() => {
                        analysisResult.style.transition = 'all 0.6s ease';
                        analysisResult.style.opacity = '1';
                        analysisResult.style.transform = 'translateY(0)';
                    }, 200);
                }

                // Beautiful scroll to results
                setTimeout(() => {
                    analysisResult.scrollIntoView({
                        behavior: 'smooth',
                        block: 'start'
                    });
                }, 600);

                // Animate content items
                setTimeout(() => {
                    animateAnalysisContent();
                }, 800);

                showNotification('üß† Analysis completed successfully!', 'success');
                console.log('‚úÖ Beautiful results displayed');

            } else {
                console.error('‚ùå Beautiful analysis failed:', result.error);
                showNotification('Analysis failed: ' + result.error, 'error');
                showTabContent();
            }
        }

        function formatBeautifulAnalysis(text) {
            if (!text) return '<p>No analysis content received.</p>';

            return text
                // Enhanced headers with beautiful styling
                .replace(/(\d+\.\s*)(.*?)(?=\n|$)/g, '<h4 class="analysis-section" style="color: #0FA3D4; margin: 2rem 0 1rem; font-weight: 600; display: flex; align-items: center; gap: 0.5rem;"><i class="fas fa-brain"></i>$1$2</h4>')
                // Bold text with beautiful gradient
                .replace(/\*\*(.*?)\*\*/g, '<strong style="background: linear-gradient(135deg, #0FA3D4, #00D4AA); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; font-weight: 600;">$1</strong>')
                // Italic text with subtle color
                .replace(/\*(.*?)\*/g, '<em style="color: #64748b; font-style: italic;">$1</em>')
                // Line breaks and paragraphs
                .replace(/\n\n/g, '</p><p style="margin-bottom: 1.5rem; line-height: 1.8;">')
                .replace(/\n/g, '<br>')
                .replace(/^(.*)$/, '<p style="margin-bottom: 1.5rem; line-height: 1.8;">$1</p>')
                // Beautiful callouts
                .replace(/(Key insight:|Important:|Note:|Warning:)/gi, '<span style="background: linear-gradient(135deg, #0FA3D4, #00D4AA); color: white; padding: 0.25rem 0.75rem; border-radius: 20px; font-size: 0.875rem; font-weight: 600; margin-right: 0.5rem;">$1</span>')
                // Emoji enhancements
                .replace(/(happy|joy|playful|content)/gi, 'üòä $1')
                .replace(/(anxious|stressed|worried|fearful)/gi, 'üò∞ $1')
                .replace(/(aggressive|angry|frustrated)/gi, 'üò† $1');
        }

        function animateAnalysisContent() {
            const sections = document.querySelectorAll('#analysisContent h4, #analysisContent p');
            sections.forEach((section, index) => {
                section.style.opacity = '0';
                section.style.transform = 'translateY(20px)';

                setTimeout(() => {
                    section.style.transition = 'all 0.5s ease';
                    section.style.opacity = '1';
                    section.style.transform = 'translateY(0)';
                }, index * 100);
            });
        }

        function resetForNewAnalysis() {
            console.log('üîÑ Beautiful reset for new analysis...');

            // Show form with beautiful animation
            showTabContent();

            setTimeout(() => {
                document.getElementById('tabContent').style.animation = 'fadeIn 0.6s ease';
            }, 100);

            // Hide results with beautiful animation
            const analysisResult = document.getElementById('analysisResult');
            if (analysisResult) {
                analysisResult.style.opacity = '0';
                analysisResult.style.transform = 'translateY(-20px)';

                setTimeout(() => {
                    analysisResult.style.display = 'none';
                }, 300);
            }

            // Reset forms with beautiful clearing animation
            const forms = [document.getElementById('petForm'), document.getElementById('cameraForm')];
            forms.forEach(form => {
                if (form) {
                    const inputs = form.querySelectorAll('.form-control, .form-select');
                    inputs.forEach((input, index) => {
                        setTimeout(() => {
                            input.value = '';
                            input.classList.remove('is-valid', 'is-invalid');

                            // Beautiful clear animation
                            input.style.transform = 'scale(0.98)';
                            setTimeout(() => {
                                input.style.transition = 'transform 0.2s ease';
                                input.style.transform = 'scale(1)';
                            }, 50);
                        }, index * 50);
                    });
                }
            });

            // Return to first tab with animation
            const formTab = document.getElementById('form-tab');
            if (formTab) {
                const tab = new bootstrap.Tab(formTab);
                tab.show();
            }

            // Beautiful scroll to top
            window.scrollTo({ top: 0, behavior: 'smooth' });

            showNotification('Ready for new analysis üöÄ', 'info');
            currentAnalysis = '';
        }

        function downloadReport() {
            console.log('üì• Beautiful download...');

            if (!currentAnalysis) {
                showNotification('No analysis to download', 'error');
                return;
            }

            try {
                const petName = document.getElementById('pet_name')?.value ||
                               document.getElementById('cam_pet_name')?.value || 'pet';
                const petBreed = document.getElementById('pet_breed')?.value ||
                                document.getElementById('cam_pet_breed')?.value || 'Unknown';
                const petType = document.getElementById('pet_type')?.value ||
                               document.getElementById('cam_pet_type')?.value || 'Unknown';

                const fileName = `${petName}_psychology_report_${new Date().toISOString().slice(0,10)}.txt`;

                const content = `
üß† PETPSYCH AI - BEHAVIORAL ANALYSIS REPORT
${'='.repeat(60)}

üìã PET INFORMATION
Name: ${petName}
Type: ${petType}
Breed: ${petBreed}
Analysis Date: ${new Date().toLocaleString()}

üìä ANALYSIS RESULTS
${currentAnalysis}

üìã DISCLAIMER
This analysis is generated by AI and should not replace professional veterinary advice.
For health concerns, please consult with a qualified veterinarian.

${'='.repeat(60)}
Generated by PetPsych AI
Powered by Gemini 1.5 Pro ‚Ä¢ ¬© 2025 PetPsych AI
                `.trim();

                const blob = new Blob([content], { type: 'text/plain;charset=utf-8' });
                const url = URL.createObjectURL(blob);

                const a = document.createElement('a');
                a.href = url;
                a.download = fileName;
                a.style.display = 'none';
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);

                showNotification('üì• Report downloaded successfully!', 'success');

            } catch (error) {
                console.error('Beautiful download error:', error);
                showNotification('Download failed. Please try again.', 'error');
            }
        }

        function showNotification(message, type = 'info', duration = 5000) {
            console.log(`üì¢ ${type.toUpperCase()}: ${message}`);

            // Remove existing notifications
            const existing = document.querySelectorAll('.beautiful-notification');
            existing.forEach(n => n.remove());

            const notification = document.createElement('div');
            notification.className = 'beautiful-notification';

            const colors = {
                success: 'linear-gradient(135deg, #10b981, #059669)',
                error: 'linear-gradient(135deg, #ef4444, #dc2626)',
                warning: 'linear-gradient(135deg, #f59e0b, #d97706)',
                info: 'linear-gradient(135deg, #0FA3D4, #00D4AA)'
            };

            const icons = {
                success: 'check-circle',
                error: 'exclamation-circle',
                warning: 'exclamation-triangle',
                info: 'info-circle'
            };

            notification.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                z-index: 9999;
                padding: 1rem 1.5rem;
                border-radius: 16px;
                color: white;
                font-weight: 500;
                max-width: 350px;
                background: ${colors[type]};
                box-shadow: 0 10px 30px rgba(0,0,0,0.2);
                backdrop-filter: blur(10px);
                transform: translateX(100px) scale(0.9);
                opacity: 0;
                transition: all 0.4s cubic-bezier(0.68, -0.55, 0.265, 1.55);
                border: 1px solid rgba(255,255,255,0.2);
            `;

            notification.innerHTML = `
                <div style="display: flex; align-items: center; gap: 10px;">
                    <i class="fas fa-${icons[type]}" style="font-size: 1.2rem;"></i>
                    <span>${message}</span>
                </div>
            `;

            document.body.appendChild(notification);

            // Beautiful animate in
            setTimeout(() => {
                notification.style.transform = 'translateX(0) scale(1)';
                notification.style.opacity = '1';
            }, 100);

            // Beautiful animate out
            setTimeout(() => {
                notification.style.transform = 'translateX(100px) scale(0.9)';
                notification.style.opacity = '0';
                setTimeout(() => {
                    if (notification.parentNode) {
                        notification.remove();
                    }
                }, 400);
            }, duration);
        }

        // Add beautiful CSS animations
        const style = document.createElement('style');
        style.textContent = `
            @keyframes fadeIn {
                from { opacity: 0; transform: translateY(20px); }
                to { opacity: 1; transform: translateY(0); }
            }

            .analysis-section {
                animation: slideInLeft 0.6s ease-out;
            }

            @keyframes slideInLeft {
                from { opacity: 0; transform: translateX(-30px); }
                to { opacity: 1; transform: translateX(0); }
            }

            .form-control:focus, .form-select:focus {
                transform: translateY(-2px);
                box-shadow: 0 8px 25px rgba(15, 163, 212, 0.15) !important;
            }

            .btn:hover {
                transform: translateY(-3px) !important;
            }

            .main-card:hover {
                transform: translateY(-8px) !important;
            }
        `;
        document.head.appendChild(style);

        console.log('üéâ Beautiful PetPsych AI fully loaded!');
    </script>
</body>
</html>
